--- /dev/null	2025-03-06 22:36:56.976826713 +0100
+++ b/variants/portduino-buildroot/platformio.ini	2025-02-22 18:11:18.000000000 +0100
@@ -1,8 +1,77 @@
-[env:buildroot]
+[buildroot_base]
 extends = portduino_base
 ; Optional libraries should be appended to `PLATFORMIO_BUILD_FLAGS`
 ; environment variable in the buildroot environment.
 build_flags = ${portduino_base.build_flags} -O0 -I variants/portduino-buildroot
+    -D ARCH_PORTDUINO
 board = buildroot
 lib_deps = ${portduino_base.lib_deps}
 build_src_filter = ${portduino_base.build_src_filter}
\ Pas de fin de ligne Ã  la fin du fichier
+
+
+[env:buildroot]
+extends = buildroot_base
+; The pkg-config commands below optionally add link flags.
+; the || : is just a "or run the null command" to avoid returning an error code
+;build_flags = ${native_base.build_flags}
+;  !pkg-config --libs libulfius --silence-errors || :
+;  !pkg-config --libs openssl --silence-errors || :
+
+[env:buildroot-tft]
+extends = buildroot_base
+build_type = release
+build_flags = ${buildroot_base.build_flags} -Os -lX11 -linput -lxkbcommon -ffunction-sections -fdata-sections -Wl,--gc-sections
+  -D MESHTASTIC_EXCLUDE_CANNEDMESSAGES=1
+  -D RAM_SIZE=16384
+  -D USE_X11=1
+  -D HAS_TFT=1
+  -D HAS_SCREEN=0
+  -D LV_BUILD_TEST=0
+  -D LV_USE_LIBINPUT=1
+  -D LV_LVGL_H_INCLUDE_SIMPLE
+  -D LV_CONF_INCLUDE_SIMPLE
+  -D LV_COMP_CONF_INCLUDE_SIMPLE
+  -D USE_LOG_DEBUG
+  -D LOG_DEBUG_INC=\"DebugConfiguration.h\"
+  -D USE_PACKET_API
+  -I lib/device-ui/generated/ui_320x240
+  !pkg-config --libs libulfius --silence-errors || :
+  !pkg-config --libs openssl --silence-errors || :
+build_src_filter = ${buildroot_base.build_src_filter}
+  -<graphics/TFTDisplay.cpp>
+  +<../lib/device-ui/generated/ui_320x240>
+  +<../lib/device-ui/generated/ui_320x240/fonts>
+  +<../lib/device-ui/resources>
+  +<../lib/device-ui/portduino>
+  +<../lib/device-ui/locale>
+  +<../lib/device-ui/source>
+
+[env:buildroot-tft-debug]
+extends = buildroot_base
+build_type = debug
+board_level = extra
+build_flags = ${buildroot_base.build_flags} -O0 -fsanitize=address -lX11 -linput -lxkbcommon
+  -D MESHTASTIC_EXCLUDE_CANNEDMESSAGES=1
+  -D DEBUG_HEAP
+  -D RAM_SIZE=16384
+  -D USE_X11=1
+  -D HAS_TFT=1
+  -D HAS_SCREEN=0
+;  -D CALIBRATE_TOUCH=0
+  -D LV_BUILD_TEST=0
+  -D LV_USE_LOG=1
+  -D LV_USE_SYSMON=1
+  -D LV_USE_PERF_MONITOR=1
+  -D LV_USE_MEM_MONITOR=0
+  -D LV_USE_PROFILER=0
+  -D LV_USE_LIBINPUT=1
+  -D LV_LVGL_H_INCLUDE_SIMPLE
+  -D LV_CONF_INCLUDE_SIMPLE
+  -D LV_COMP_CONF_INCLUDE_SIMPLE
+  -D USE_LOG_DEBUG
+  -D LOG_DEBUG_INC=\"DebugConfiguration.h\"
+  -D USE_PACKET_API
+  -I lib/device-ui/generated/ui_320x240
+  !pkg-config --libs libulfius --silence-errors || :
+  !pkg-config --libs openssl --silence-errors || :
+build_src_filter = ${env:buildroot-tft.build_src_filter}
